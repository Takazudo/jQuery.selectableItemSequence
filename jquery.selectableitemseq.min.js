/*! jQuery.selectableItemSequence (https://github.com/Takazudo/jQuery.imgUtil)
 * lastupdate: 2013-07-09
 * version: 0.0.0
 * author: 'Takazudo' Takeshi Takatsudo <takazudo@gmail.com>
 * License: MIT */
(function(){var t={}.hasOwnProperty,e=function(e,i){function s(){this.constructor=e}for(var n in i)t.call(i,n)&&(e[n]=i[n]);return s.prototype=i.prototype,e.prototype=new s,e.__super__=i.prototype,e};(function(t,i){var s;return s={},s.cloneArray=function(t){var e,i,s,n;for(i=[],s=0,n=t.length;n>s;s++)e=t[s],i.push(e);return i.reverse()},s.Item=function(i){function n(e,i){this.$el=e,this.active=!1,this.options=t.extend({},s.Item.defaults,i),this._eventify(),this._handleInitialStats()}return e(n,i),n.defaults={class_inactive:null,class_active:null,index:null},n.prototype._eventify=function(){var t=this;return this.$el.bind("click",function(e){return e.preventDefault(),t.trigger("click")}),this},n.prototype._handleInitialStats=function(){return this.$el.hasClass(this.options.class_active)&&(this.active=!0),this},n.prototype.select=function(){return this.active===!0?this:(this.options.class_inactive&&this.$el.removeClass(this.options.class_inactive),this.$el.addClass(this.options.class_active),this.active=!0,this)},n.prototype.deselect=function(){return this.active===!1?this:(this.$el.removeClass(this.options.class_active),this.options.class_inactive&&this.$el.addClass(this.options.class_inactive),this.active=!1,this)},n}(i.EveEve),s.Sequence=function(i){function n(e,i){this.$el=e,this.disabled=!1,this.options=t.extend({},s.Sequence.defaults,i),this.options.multiSelect&&(this.options.deselectOnActiveItemClick=!0),this._createItemInstances(),this._eventifyItems()}return e(n,i),n.defaults={selector_item:null,class_activeItem:null,class_inactiveItem:null,eventPrefix:"selectableitemsequence.",deselectOnActiveItemClick:!1,multiSelect:!1,max:null},n.prototype._createItemInstances=function(){var e=this;return this._items=[],this.$el.find(this.options.selector_item).each(function(i,n){var r,o,c;return r=t(n),c={class_inactive:e.options.class_inactiveItem,class_active:e.options.class_activeItem,index:i},o=new s.Item(r,c),e._items.push(o)}),this},n.prototype._eventifyItems=function(){var t,e,i,s,n,r=this;for(n=this._items,e=function(t){t.on("click",function(){if(!r.disabled){if(r.options.deselectOnActiveItemClick&&t.active)return r.deselect(t);if(!r.options.max||r.countSelected()!==r.options.max)return r.select(t)}})},i=0,s=n.length;s>i;i++)t=n[i],e(t);return this},n.prototype.triggerEvent=function(t,e){return null==e&&(e={}),this.trigger(t,e),this.$el.trigger(""+this.options.eventPrefix+t,e),this},n.prototype.isAnyItemActive=function(){var t,e,i,s;for(s=this._items,e=0,i=s.length;i>e;e++)if(t=s[e],t.active)return!0;return!1},n.prototype.isFirstItem=function(t){return this._items[0]===t},n.prototype.isLastItem=function(t){return this._items[this._items.length-1]===t},n.prototype.select=function(t){var e;return t.active?this:(this.options.multiSelect||this.deselectItemWithout(t),t.select(),e={el:t.$el,index:t.options.index,isFirstItem:this.isFirstItem(t),isLastItem:this.isLastItem(t)},this.triggerEvent("select",e),this.options.max&&this.countSelected()===this.options.max&&(this._reachedMax=!0,this.triggerEvent("maxselect")),this)},n.prototype.deselect=function(t){var e;return t.active?(t.deselect(),e={el:t.$el,index:t.options.index,isFirstItem:this.isFirstItem(t),isLastItem:this.isLastItem(t)},this.triggerEvent("deselect",e),this.isAnyItemActive()===!1&&this.triggerEvent("allitemdeselected"),this.options.max&&this._reachedMax===!0&&(this._reachedMax=!1,this.triggerEvent("maxselectrelease")),this):this},n.prototype.selectByIndex=function(t){var e;return e=this.findItemWhoseIndexIs(t),null===e?this:(this.select(e),this)},n.prototype.selectByIndexes=function(t){var e,i,s;for(i=0,s=t.length;s>i;i++)e=t[i],this.selectByIndex(e);return this},n.prototype.deselectAll=function(){var t,e,i,s;if(e=this.findActiveItems(),0===e.length)return this;for(i=0,s=e.length;s>i;i++)t=e[i],this.deselect(t);return this},n.prototype.deselectItemWithout=function(t){var e,i,s,n;for(n=this._items,i=0,s=n.length;s>i;i++)e=n[i],e!==t&&this.deselect(e);return this},n.prototype.findItemWhoseIndexIs=function(t){var e,i,s,n;for(n=this._items,i=0,s=n.length;s>i;i++)if(e=n[i],e.options.index===t)return e;return null},n.prototype.findActiveItems=function(){var t,e,i,s,n;for(e=[],n=this._items,i=0,s=n.length;s>i;i++)t=n[i],t.active&&e.push(t);return e},n.prototype.findInactiveItems=function(){var t,e,i,s,n;for(e=[],n=this._items,i=0,s=n.length;s>i;i++)t=n[i],t.active||e.push(t);return e},n.prototype.findNextOf=function(t){var e,i,s,n,r;for(e=!1,r=this._items,s=0,n=r.length;n>s;s++){if(i=r[s],e)return i;i===t&&(e=!0)}return null},n.prototype.findPrevOf=function(t){var e,i,n,r,o;for(n=s.cloneArray(this._items),e=!1,r=0,o=n.length;o>r;r++){if(i=n[r],e)return i;i===t&&(e=!0)}return null},n.prototype.selectNext=function(){var t,e;return t=this.findActiveItems(),0===t.length?this:(e=this.findNextOf(t[0]),null===e?this:(this.select(e),this))},n.prototype.selectPrev=function(){var t,e;return t=this.findActiveItems(),0===t.length?this:(e=this.findPrevOf(t[0]),null===e?this:(this.select(e),this))},n.prototype.selectUpTo=function(t){var e,i,s,n=this;if(1>t)return this;for(i=this._items.length-1,s=function(){var e;return e=n.countSelected(),e>=t?!0:n.options.max&&n.options.max===e?!0:!1},e=0;i>=e;){if(s())return this;this.selectByIndex(e),e+=1}return this},n.prototype.countSelected=function(){return this.getSelectedElements().length},n.prototype.disable=function(){return this.disabled=!0,this},n.prototype.enable=function(){return this.disabled=!1,this},n.prototype.getSelectedElements=function(){var e,i,s,n,r;if(e=t(),s=this.findActiveItems(),0!==s.length)for(n=0,r=s.length;r>n;n++)i=s[n],e=e.add(i.$el);return e},n}(i.EveEve),t.fn.selectableItemSequence=function(e){return this.each(function(i,n){var r;return r=t(n),r.data("selectableitemsequence",new s.Sequence(r,e))})},t.SelectableItemSequenceNs=s,t.SelectableItemSequence=s.Sequence})(jQuery,window,document)}).call(this);
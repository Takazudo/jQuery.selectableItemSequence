/*! jQuery.selectableItemSequence (https://github.com/Takazudo/jQuery.imgUtil)
 * lastupdate: 2013-05-25
 * version: 0.0.0
 * author: 'Takazudo' Takeshi Takatsudo <takazudo@gmail.com>
 * License: MIT */
(function(){var t=[].slice,e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};(function(e){var n;return n={},n.cloneArray=function(t){var e,i,n,s;for(i=[],n=0,s=t.length;s>n;n++)e=t[n],i.push(e);return i.reverse()},n.Event=function(){function e(){}return e.prototype.on=function(t,e){var i,n,s,r,c;for(null==this._callbacks&&(this._callbacks={}),i=t.split(" "),r=0,c=i.length;c>r;r++)n=i[r],(s=this._callbacks)[n]||(s[n]=[]),this._callbacks[n].push(e);return this},e.prototype.once=function(t,e){return this.on(t,function(){return this.off(t,arguments.callee),e.apply(this,arguments)}),this},e.prototype.trigger=function(){var e,i,n,s,r,c,o;if(e=arguments.length>=1?t.call(arguments,0):[],n=e.shift(),s=null!=(o=this._callbacks)?o[n]:void 0){for(r=0,c=s.length;c>r&&(i=s[r],i.apply(this,e)!==!1);r++);return this}},e.prototype.off=function(t,e){var i,n,s,r,c,o;if(!t)return this._callbacks={},this;if(s=null!=(o=this._callbacks)?o[t]:void 0,!s)return this;if(!e)return delete this._callbacks[t],this;for(n=r=0,c=s.length;c>r;n=++r)if(i=s[n],i===e){s=s.slice(),s.splice(n,1),this._callbacks[t]=s;break}return this},e}(),n.Item=function(t){function s(t,i){this.$el=t,this.active=!1,this.options=e.extend({},n.Item.defaults,i),this._eventify()}return i(s,t),s.defaults={class_active:null,index:null},s.prototype._eventify=function(){var t=this;return this.$el.bind("click",function(e){return e.preventDefault(),t.trigger("click")}),this},s.prototype.select=function(t){return null==t&&(t=!1),this.active===!0?this:(this.$el.addClass(this.options.class_active),this.active=!0,this)},s.prototype.deselect=function(){return this.active===!1?this:(this.$el.removeClass(this.options.class_active),this.active=!1,this)},s}(n.Event),n.Sequence=function(t){function s(t,i){this.$el=t,this.options=e.extend({},n.Sequence.defaults,i),this.options.multiSelect&&(this.options.deselectOnActiveItemClick=!0),this._createItemInstances(),this._eventifyItems()}return i(s,t),s.defaults={selector_item:null,class_activeItem:null,eventPrefix:"selectableitemsequence.",deselectOnActiveItemClick:!1,multiSelect:!1},s.prototype._createItemInstances=function(){var t=this;return this._items=[],this.$el.find(this.options.selector_item).each(function(i,s){var r,c,o;return r=e(s),o={class_active:t.options.class_activeItem,index:i},c=new n.Item(r,o),t._items.push(c)}),this},s.prototype._eventifyItems=function(){var t,e,i,n,s,r=this;for(s=this._items,e=function(t){t.on("click",function(){return r.options.deselectOnActiveItemClick&&t.active?r.deselect(t):r.select(t)})},i=0,n=s.length;n>i;i++)t=s[i],e(t);return this},s.prototype.triggerEvent=function(t,e){return null==e&&(e={}),this.trigger(t,e),this.$el.trigger(""+this.options.eventPrefix+t,e),this},s.prototype.isAnyItemActive=function(){var t,e,i,n;for(n=this._items,e=0,i=n.length;i>e;e++)if(t=n[e],t.active)return!0;return!1},s.prototype.isFirstItem=function(t){return this._items[0]===t},s.prototype.isLastItem=function(t){return this._items[this._items.length-1]===t},s.prototype.select=function(t){var e;return t.active?this:(this.options.multiSelect||this.deselectItemWithout(t),t.select(),e={el:t.$el,index:t.options.index,isFirstItem:this.isFirstItem(t),isLastItem:this.isLastItem(t)},this.triggerEvent("select",e),this)},s.prototype.deselect=function(t){var e;return t.active?(t.deselect(),e={el:t.$el,index:t.options.index,isFirstItem:this.isFirstItem(t),isLastItem:this.isLastItem(t)},this.triggerEvent("deselect",e),this.isAnyItemActive()===!1&&this.triggerEvent("allitemdeselected"),this):this},s.prototype.selectByIndex=function(t){var e;return e=this.findItemWhoseIndexIs(t),null===e?this:(this.select(e),this)},s.prototype.selectByIndexes=function(t){var e,i,n;for(i=0,n=t.length;n>i;i++)e=t[i],this.selectByIndex(e);return this},s.prototype.deselectAll=function(){var t,e,i,n;if(e=this.findActiveItems(),0===e.length)return this;for(i=0,n=e.length;n>i;i++)t=e[i],this.deselect(t);return this},s.prototype.deselectItemWithout=function(t){var e,i,n,s;for(s=this._items,i=0,n=s.length;n>i;i++)e=s[i],e!==t&&this.deselect(e);return this},s.prototype.findItemWhoseIndexIs=function(t){var e,i,n,s;for(s=this._items,i=0,n=s.length;n>i;i++)if(e=s[i],e.options.index===t)return e;return null},s.prototype.findActiveItems=function(){var t,e,i,n,s;for(e=[],s=this._items,i=0,n=s.length;n>i;i++)t=s[i],t.active&&e.push(t);return e},s.prototype.findNextOf=function(t){var e,i,n,s,r;for(e=!1,r=this._items,n=0,s=r.length;s>n;n++){if(i=r[n],e)return i;i===t&&(e=!0)}return null},s.prototype.findPrevOf=function(t){var e,i,s,r,c;for(s=n.cloneArray(this._items),e=!1,r=0,c=s.length;c>r;r++){if(i=s[r],e)return i;i===t&&(e=!0)}return null},s.prototype.selectNext=function(){var t,e;return t=this.findActiveItems(),0===t.length?this:(e=this.findNextOf(t[0]),null===e?this:(this.select(e),this))},s.prototype.selectPrev=function(){var t,e;return t=this.findActiveItems(),0===t.length?this:(e=this.findPrevOf(t[0]),null===e?this:(this.select(e),this))},s.prototype.getSelectedElements=function(){var t,i,n,s,r;if(t=e(),n=this.findActiveItems(),0!==n.length)for(s=0,r=n.length;r>s;s++)i=n[s],t=t.add(i.$el);return t},s}(n.Event),e.fn.selectableItemSequence=function(t){return this.each(function(i,s){var r;return r=e(s),r.data("selectableitemsequence",new n.Sequence(r,t))})},e.SelectableItemSequenceNs=n,e.SelectableItemSequence=n.Sequence})(jQuery,window,document)}).call(this);